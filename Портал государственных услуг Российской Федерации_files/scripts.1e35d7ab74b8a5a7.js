(function(P){P.IFCCrypto=function(o){this.getAlias=function(){return IFCConst.emptyString(o.alias)},this.getName=function(){return IFCConst.emptyString(o.name)},this.isPKCS11=function(){return o.type===IFCConst.IFC_CRYPTO_PKCS11},this.isCAPI=function(){return o.type===IFCConst.IFC_CRYPTO_CAPI},this.isCAPI_LINUX=function(){return o.type===IFCConst.IFC_CRYPTO_CAPI_LINUX},this.getPath=function(){return IFCConst.emptyString(o.path)},this.getNumber=function(){return IFCConst.emptyString(o.num)},this.getDescription=function(){return IFCConst.emptyString(o.description)},this.getSerialNumber=function(){return IFCConst.emptyString(o.serial_number)},this.getModel=function(){return IFCConst.emptyString(o.model)},this.getSkipPKCS11List=function(){return IFCConst.emptyString(o.skip_pkcs11_list)},this.getAlg=function(){return IFCConst.emptyString(o.alg)},this.getCryptoId=function(){return o.type===IFCConst.IFC_CRYPTO_PKCS11?o.crypto_id=o.alias+"/"+o.num:(o.type===IFCConst.IFC_CRYPTO_CAPI||o.type===IFCConst.IFC_CRYPTO_CAPI_LINUX)&&(o.crypto_id=o.alias),IFCConst.emptyString(o.crypto_id)},this.getExtendedKeyUsage=function(){for(var C=this.getAlias(),s=[{alias:"JaCarta",oid:"1.2.643.3.205.110.1"},{alias:"ruTokenECP",oid:"1.2.643.3.205.110.7"},{alias:"VIPNet",oid:"1.2.643.3.205.110.6"},{alias:"SignalCom",oid:"1.2.643.3.205.110.8"},{alias:"LISSI-CSP",oid:"1.2.643.3.205.110.9"},{alias:"CryptoPro",oid:"1.2.643.3.205.110.2"}],f=0;f<s.length;f++)if(C.indexOf(s[f].alias)>=0)return s[f].oid;return""},this.getCertificatePolicies=function(){for(var C=this.getAlias(),s=[{alias:"JaCarta",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"ruTokenECP",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"CryptoPro",oid:IFCConst.OID_KC1},{alias:"VIPNet",oid:IFCConst.OID_KC1},{alias:"SignalCom",oid:IFCConst.OID_KC1},{alias:"LISSI-CSP",oid:IFCConst.OID_KC1}],f=0;f<s.length;f++)if(C.indexOf(s[f].alias)>=0)return s[f].oid;return IFCConst.OID_KC1}},P.IFCCertificate=function(o,C){this.getSerialNumber=function(){return IFCConst.emptyString(o.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(o.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(o.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(o.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(o.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var s=this.getSignAlgOid();return s===IFCConst.OID_GOSTR3410_2012_256||s===IFCConst.OID_GOSTR3410_2012_512||s===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var s=this.getSignAlgOid();return s===IFCConst.OID_GOSTR3410_2001?"gost_2001":s===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":s===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(o.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getId=function(){return IFCConst.emptyString(o.id)},this.getContainerId=function(){return C.getCryptoId()+"/"+IFCConst.emptyString(o.id)},this.getCryptoId=function(){return C.getCryptoId()},this.isPKCS11=function(){return C.isPKCS11()},this.isCAPI=function(){return C.isCAPI()},this.isCAPI_LINUX=function(){return C.isCAPI_LINUX()},this.checkDate=function(s){return isNaN(new Date(s).getTime())?s.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):s}},P.IFCCertificateInfo=function(o){this.getSerialNumber=function(){return IFCConst.emptyString(o.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(o.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(o.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(o.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(o.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var C=this.getSignAlgOid();return C===IFCConst.OID_GOSTR3410_2012_256||C===IFCConst.OID_GOSTR3410_2012_512||C===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var C=this.getSignAlgOid();return C===IFCConst.OID_GOSTR3410_2001?"gost_2001":C===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":C===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(o.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getBase64=function(){return IFCConst.emptyString(o.base64)},this.getPem=function(){return IFCConst.emptyString(o.pem)},this.getVersion=function(){return IFCConst.emptyString(o.version)},this.getExtensionsString=function(){return IFCConst.emptyString(o.extensions)},this.getPrintableText=function(){return this.getPrintable("\n","\t",", ")},this.getPrintableHTML=function(){return this.getPrintable("<br />","&nbsp;&nbsp;",", ")},this.getPrintable=function(C,s,f){C||(C="\n"),s||(s="\t"),f||(f=", ");var c="\u041d\u043e\u043c\u0435\u0440 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430: "+this.getSerialNumber()+C+"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430:"+C+s+s+"\u0441 "+this.getValidFrom()+C+s+s+"\u043f\u043e "+this.getValidTo()+C+C+s+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+C+C+"\u0424\u0430\u043c\u0438\u043b\u0438\u044f, \u0438\u043c\u044f, \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e: "+this.getSubjectDN().getCommonName()+C+"\u0421\u0442\u0440\u0430\u0445\u043e\u0432\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043b\u0438\u0446\u0435\u0432\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430: "+this.getSubjectDN().getSNILS()+C+C+s+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+C+C+"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e  \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCommonName()+C+"\u041c\u0435\u0441\u0442\u043e  \u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCountryName()+f+this.getIssuerDN().getStateOrProvinceName()+f+this.getIssuerDN().getLocalityName()+f+this.getIssuerDN().getStreetAddress()+C;return this.getIssuerDN().getSurname()?c+="\u0414\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0435 \u043b\u0438\u0446\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getSurname():this.getIssuerDN().getGivenName()?c+=f+this.getIssuerDN().getGivenName()+C:c+=C,c+(s+"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430")+C+C+this.getExtensionsString().replace(/(\r\n|\n|\r)/gm,C).replace(/^\s+/gm,s)},this.checkDate=function(C){return isNaN(new Date(C).getTime())?C.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):C}},P.IFCDN=function(o,C){var s=function(u){switch(u.toLowerCase()){case"commonname":case"cn":return IFCConst.OID_COMMON_NAME;case"surname":return IFCConst.OID_SURNAME;case"givenname":return IFCConst.OID_GIVEN_NAME;case"countryname":case"c":return IFCConst.OID_COUNTRY_NAME;case"stateorprovincename":return IFCConst.OID_STATE_OR_PROVINCE_NAME;case"localityname":case"l":return IFCConst.OID_LOCALITY_NAME;case"streetaddress":case"street":return IFCConst.OID_STREET_ADDRESS;case"organizationname":case"o":return IFCConst.OID_ORGANIZATION_NAME;case"organizationunitname":case"ou":return IFCConst.OID_ORGANIZATION_UNIT_NAME;case"title":return IFCConst.OID_TITLE;case"emailaddress":case"email":return IFCConst.OID_EMAIL_ADDRESS;case"ogrn":return IFCConst.OID_OGRN;case"snils":return IFCConst.OID_SNILS;case"inn":return IFCConst.OID_INN;default:return u}},f=o.split("\\,").join("[escaped_comma]").split(C);this.dnData=new Object;for(var c=0;c<f.length;c++){var a=f[c].split("=");null==a[1]&&(a[1]="");var m=a[0].trim(),l=a[1].trim().split("[escaped_comma]").join(",");this.dnData[s(m)]=l}this.getCommonName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COMMON_NAME])},this.getSurname=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SURNAME])},this.getGivenName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_GIVEN_NAME])},this.getCountryName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COUNTRY_NAME])},this.getStateOrProvinceName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STATE_OR_PROVINCE_NAME])},this.getLocalityName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_LOCALITY_NAME])},this.getStreetAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STREET_ADDRESS])},this.getOrganizationName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_NAME])},this.getOrganizationUnitName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_UNIT_NAME])},this.getTitle=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_TITLE])},this.getEmailAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_EMAIL_ADDRESS])},this.getOGRN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_OGRN])},this.getSNILS=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SNILS])},this.getINN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_INN])},this.getValueByOid=function(u){return IFCConst.emptyString(this.dnData[s(u)])},this.getSubjectArray=function(){var u=new Object,S=0;for(var N in this.dnData)u["oid_"+ ++S]=N,u["oid_type_"+S]=IFCConst.getDNDataType(N),u["value_"+S]=this.dnData[N];return u.oids_count=S,u},this.getOneLine=function(){var u="";return this.getCountryName()&&(u+="c="+this.getCountryName()+", "),this.getStateOrProvinceName()&&(u+="stateorprovincename="+this.getStateOrProvinceName()+", "),this.getLocalityName()&&(u+="l="+this.getLocalityName()+", "),this.getCommonName()&&(u+="cn="+this.getCommonName()+", "),this.getSurname()&&(u+="surname="+this.getSurname()+", "),this.getGivenName()&&(u+="givenname="+this.getGivenName()+", "),this.getStreetAddress()&&(u+="street="+this.getStreetAddress()+", "),this.getOrganizationName()&&(u+="o="+this.getOrganizationName()+", "),this.getOrganizationUnitName()&&(u+="ou="+this.getOrganizationUnitName()+", "),this.getTitle()&&(u+="title="+this.getTitle()+", "),this.getEmailAddress()&&(u+="email="+this.getEmailAddress()+", "),this.getOGRN()&&(u+="ogrn="+this.getOGRN()+", "),this.getSNILS()&&(u+="snils="+this.getSNILS()+", "),this.getINN()&&(u+="inn="+this.getINN()+", "),u.substring(0,u.length-2)}},P.IFCCertificateRequest=function(o,C){this.getContainerId=function(){return o},this.getCsr=function(){return C}},P.IFCEncrypted=function(o,C,s){this.getData=function(){return o},this.getKey=function(){return C},this.getCertificate=function(){return s}},P.IFCHash=function(o){this.getBase64=function(){return o},this.getHexBinary=function(){return s(C(o))},this.getPlainData=function(){return C(o)};var C=function(f){var a,c={},l=[],u="",S=String.fromCharCode,N=[[65,91],[97,123],[48,58],[43,44],[47,48]];for(z in N)for(a=N[z][0];a<N[z][1];a++)l.push(S(a));for(a=0;a<64;a++)c[l[a]]=a;for(a=0;a<f.length;a+=72){var E,F=0,O=0,R=f.substring(a,a+72);for(E=0;E<R.length;E++)for(F=(F<<6)+c[R.charAt(E)],O+=6;O>=8;)u+=S((F>>>(O-=8))%256)}return u},s=function(f){for(var a,c=[],m="",l=0,u=f.length;l<u;++l)a=f.charCodeAt(l),c.push((a>>4).toString(16),(15&a).toString(16));for(String.prototype.concat.apply("",c),l=0;l<c.length;l++)m+=c[l];return m}},P.IFCConst={IFC_DATATYPE_DATA:1,IFC_DATATYPE_DATA_BASE64:2,IFC_DATATYPE_HASH:3,IFC_DATATYPE_HASH_BASE64:4,IFC_DATATYPE_FILENAME:5,IFC_CRYPTO_PKCS11:"pkcs11",IFC_CRYPTO_CAPI:"capi",IFC_CRYPTO_CAPI_LINUX:"capi_linux",OID_COMMON_NAME:"2.5.4.3",OID_SURNAME:"2.5.4.4",OID_GIVEN_NAME:"2.5.4.42",OID_COUNTRY_NAME:"2.5.4.6",OID_STATE_OR_PROVINCE_NAME:"2.5.4.8",OID_LOCALITY_NAME:"2.5.4.7",OID_STREET_ADDRESS:"2.5.4.9",OID_ORGANIZATION_NAME:"2.5.4.10",OID_ORGANIZATION_UNIT_NAME:"2.5.4.11",OID_TITLE:"2.5.4.12",OID_EMAIL_ADDRESS:"1.2.840.113549.1.9.1",OID_OGRN:"1.2.643.100.1",OID_SNILS:"1.2.643.100.3",OID_INN:"1.2.643.3.131.1.1",OID_KC1:"1.2.643.100.113.1",OID_KC2:"1.2.643.100.113.2",OID_KC3:"1.2.643.100.113.3",OID_GOSTR3410_2001:"1.2.643.2.2.19",OID_GOSTR3410_2012_256:"1.2.643.7.1.1.1.1",OID_GOSTR3410_2012_512:"1.2.643.7.1.1.1.2",DN_SEPARATOR_PLUGIN:"\n",DN_SEPARATOR_INPUT:",",IFC_CERT_LOAD_FROM_CONTAINER:1,IFC_CERT_LOAD_FROM_FILE:2,IFC_CERT_LOAD_FROM_STRING:3,IFC_SIGNTYPE_SIMPLE:1,IFC_SIGNTYPE_SIMPLE_REVERSE:2,IFC_SIGNTYPE_CMS_ATTACHED:3,IFC_SIGNTYPE_CMS_DETACHED:4,IFC_SIGNTYPE_CADES_BES_ATTACHED:5,IFC_SIGNTYPE_CADES_BES_DETACHED:6,IFC_HARDWARE_HASH:1,IFC_SOFTWARE_HASH:2,IFC_BASE64:1,IFC_RAW:0,IFC_SHOW_CSP_UI:1,IFC_HIDE_CSP_UI:0,IFC_X509_INFO_CERT_BASE64ENCODED:1,IFC_X509_INFO_CERT_DER:2,IFC_X509_INFO_CERT_VERSION:3,IFC_X509_INFO_CERT_SERIALNUMBER:4,IFC_X509_INFO_CERT_SUBJECT:5,IFC_X509_INFO_CERT_ISSUER:6,IFC_X509_INFO_CERT_VALIDFROM:7,IFC_X509_INFO_CERT_VALIDTO:8,IFC_X509_INFO_CERT_X509EXTENSIONS:9,IFC_X509_INFO_CERT_PEM:10,IFC_X509_INFO_CERT_ALG:11,IFC_CERT_UNKNOWN:0,IFC_CERT_DER:1,IFC_CERT_BASE64:2,IFC_CERT_PEM:3,IFC_REQ_DER:0,IFC_REQ_PEM:1,IFC_REQ_BASE64ENCODED:2,P11_PIN_TYPE_USER:0,P11_PIN_TYPE_ADMIN:1,IFC_PRINTABLE_STRING:19,IFC_IA5STRING:22,IFC_NUMERICSTRING:18,IFC_UTF8STRING:12,IFC_OCTET_STRING:4,IFC_BMPSTRING:30,APDU_FORMAT_RAW:0,APDU_FORMAT_TEXT:1,SHOW_SAFETOUCH:0,getDNDataType:function(o){var C;switch(o){case this.OID_COUNTRY_NAME:C=this.IFC_PRINTABLE_STRING;break;case this.OID_SNILS:case this.OID_OGRN:case this.OID_INN:C=this.IFC_NUMERICSTRING;break;case this.OID_EMAIL_ADDRESS:C=this.IFC_IA5STRING;break;default:C=IFCConst.IFC_UTF8STRING}return C},emptyString:function(o){return null==o?"":o}},P.IFCError={IFC_GENERAL_ERROR:-1,IFC_OK:0,IFC_ERROR_UNKNOWN:1,IFC_ERROR_CONFIG:2,IFC_ERROR_RECORD_MAX:3,IFC_ERROR_CONFIG_EMPTY:4,IFC_BAD_PARAMS:5,IFC_ERROR_MALLOC:6,IFC_ALIAS_NOT_FOUND:7,IFC_ERROR_STORE:8,IFC_CERT_NOT_FOUND:9,IFC_CONTAINER_NOT_FOUND:10,IFC_UNSUPPORTED_FORMAT:11,IFC_KEY_NOT_FOUND:12,IFC_BAD_IN_TYPE:13,IFC_BAD_SIGN_TYPE:14,IFC_BAD_HASH_CONTEXT:15,IFC_BAD_TYPE_PIN:16,IFC_NOT_SUPPORTED:17,IFC_SLOT_NOT_INIT:18,IFC_ERROR_VERIFY:19,IFC_ERROR_BASE64:20,IFC_SC_ERROR:21,IFC_ENGINE_ERROR:22,IFC_P11_ERROR:23,IFC_P11_NO_TOKENS_FOUND:25,IFC_PARSE_XML_ERROR:26,IFC_XPATH_ERROR:27,IFC_CANON_XML_ERROR:28,IFC_P11_LOGIN_ERROR:160,IFC_UNICODE_ERROR:161,IFC_ENCODINGS_ERROR:162,IFC_INIT_ERROR:163,IFC_CRYPTO_NOT_FOUND:164,IFC_PLUGIN_UNDEFINED_ERROR:256,IFC_P11_INVALID_PIN_ERROR:257,getErrorDescription:function(o){switch(o){case IFCError.IFC_GENERAL_ERROR:return"\u041e\u0431\u0449\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430";case IFCError.IFC_OK:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e";case IFCError.IFC_ERROR_UNKNOWN:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_ERROR_CONFIG:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_RECORD_MAX:return"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_CONFIG_EMPTY:return"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043e\u043f\u0435\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_BAD_PARAMS:return"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_ERROR_MALLOC:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438";case IFCError.IFC_ALIAS_NOT_FOUND:return"\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a \u043a\u0440\u0438\u043f\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_ERROR_STORE:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\u043c";case IFCError.IFC_CERT_NOT_FOUND:return"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_CONTAINER_NOT_FOUND:return"\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_UNSUPPORTED_FORMAT:return"\u0424\u043e\u0440\u043c\u0430\u0442 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_KEY_NOT_FOUND:return"\u041a\u043b\u044e\u0447 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_IN_TYPE:return"\u0422\u0438\u043f \u0432\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_SIGN_TYPE:return"\u0422\u0438\u043f \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_HASH_CONTEXT:return"\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0445\u0435\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_TYPE_PIN:return"\u0422\u0438\u043f \u043f\u0438\u043d-\u043a\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_NOT_SUPPORTED:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_SLOT_NOT_INIT:return"\u0421\u043b\u043e\u0442 \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d";case IFCError.IFC_ERROR_VERIFY:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0438";case IFCError.IFC_ERROR_BASE64:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438 BASE64";case IFCError.IFC_SC_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0441\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442";case IFCError.IFC_ENGINE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430";case IFCError.IFC_P11_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u043e\u0439 PKCS#11";case IFCError.IFC_P11_NO_TOKENS_FOUND:return"\u0421\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430";case IFCError.IFC_PARSE_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 XML";case IFCError.IFC_XPATH_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f XPath";case IFCError.IFC_CANON_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u0430\u043d\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 XML";case IFCError.IFC_P11_LOGIN_ERROR:return"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0438\u043d-\u043a\u043e\u0434";case IFCError.IFC_UNICODE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 UNICODE";case IFCError.IFC_ENCODINGS_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438";case IFCError.IFC_INIT_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_CRYPTO_NOT_FOUND:return"\u0421\u041a\u0417\u0418 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e";case IFCError.IFC_PLUGIN_UNDEFINED_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_P11_INVALID_PIN_ERROR:return"\u041f\u0438\u043d-\u043a\u043e\u0434 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u043c";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})})(window),function(P){P.IFCPlugin=function(o,C,s){var c="",a=null;function m(e){if(document.createEvent){var r=document.createEvent("Event");r.initEvent(e,!0,!0),document.dispatchEvent(r)}else document.documentElement[e]++}function S(){var e=navigator.userAgent;if(-1!==e.search("Safari")&&-1!==e.search("Version")){var r=e.indexOf("Version")+8,t=e.substr(r);if(t){var n=r+t.indexOf(".");if((t?parseInt(e.substring(r,n),10):0)>=12)return!0}}return!1}function N(){for(var e=navigator.userAgent,r=["Firefox","Chrome","Opera","Edge","YaBrowser","Safari"],t=0;t<r.length;t++){if(-1!==e.search(r[t])&&"Firefox"===r[t]){var n=e.indexOf(r[t])+8,i=e.substr(n);if(i){var _=n+i.indexOf(".");if((i?parseInt(e.substring(n,_),10):0)>=50)return!0}break}if(-1!==e.search(r[t])&&"Safari"===r[t]&&-1!==e.search("Version")){var h=e.indexOf("Version")+8,d=e.substr(h);if(d){var A=h+d.indexOf(".");if((d?parseInt(e.substring(h,A),10):0)>=12)return!0}break}if(-1!==e.search(r[t]))return!0}return!1}function F(e,r){a.send({func_name:"get_list_info",params:{cryptoType:e}},function(t){if(IFCError.IFC_OK===t.error_code){for(var n=[],i=0;i<t.ifc_list.length;i++)(t.ifc_list[i].type===e||null==e)&&n.push(new IFCCrypto(t.ifc_list[i]));r({error_code:IFCError.IFC_OK,ifc_list:n})}else r(t)})}function p(e){return F(null,e)}function E(e,r){p(function(t){if(IFCError.IFC_OK===t.error_code){for(var n=0;n<t.ifc_list.length;n++)if(e===t.ifc_list[n].getCryptoId())return void r({error_code:IFCError.IFC_OK,crypto:t.ifc_list[n]});r({error_code:IFCError.IFC_CRYPTO_NOT_FOUND,crypto})}else r(t)})}function O(e){if(!e)return"";for(var r=["CryptoPro","VIPNet","SignalCom","LISSI-CSP"],t=0;t<r.length;t++)if(e.indexOf(r[t])>=0)return e.substring(0,e.indexOf("/"));return e.substring(0,e.lastIndexOf("/"))}function R(e,r,t,n,i,_,I){E(O(e),function(h){IFCError.IFC_OK===h.error_code?(typeof I>"u"&&(I=IFCConst.IFC_SHOW_CSP_UI),a.send({func_name:"sign",params:{containerId:e,userPin:r||"",inDataType:n,data:t,hashType:IFCConst.IFC_HARDWARE_HASH,signType:i,cspUI:I,outDataType:IFCConst.IFC_BASE64}},_)):_(h)})}function D(e,r,t,n,i,_,I){_?G(_,function(h){if(IFCError.IFC_OK===h.error_code){var d=h.x509Handle;a.send({func_name:"verify",params:{containerId:e,inDataType:i,data:n,signType:t,sign:r,x509Handle:d}},function(A){var oe,K=A.error_code;IFCError.IFC_OK===A.error_code&&(oe=A.verify_result),T(d,function(ae){IFCError.IFC_OK===ae.error_code?I({error_code:K,verify_result:oe}):I(ae)})})}else I(h)}):a.send({func_name:"verify",params:{containerId:e,inDataType:i,data:n,signType:t,sign:r,x509Handle:0}},I)}function J(e,r,t,n,i,_,I,h){E(O(e),function(d){IFCError.IFC_OK===d.error_code?(typeof h>"u"&&(h=1),a.send({func_name:"sign_xml",params:{containerId:e,userPin:r||"",wsu_id:t,inDataType:i,data:n,cspUI:h,outDataType:_}},I)):I(d)})}function V(e,r,t,n,i){a.send({func_name:"verify_xml",params:{containerId:e,wsu_id:r,inDataType:n,sign:t}},function(_){IFCError.IFC_OK===_.error_code?i({error_code:_.error_code,verify_result:_.verify_result}):i(_)})}function g(e,r,t,n){a.send({func_name:"hash",params:{containerId:e,inDataType:r,data:t,outDataType:IFCConst.IFC_BASE64}},function(i){IFCError.IFC_OK===i.error_code?n({error_code:IFCError.IFC_OK,hash:new IFCHash(i.hashValue)}):n(i)})}function M(e,r){p(function(t){if(IFCError.IFC_OK===t.error_code){for(var n=t.ifc_list,i=[],_=0;_<n.length;_++)i.push(n[_].getCryptoId());a.send({func_name:"get_list_certs_by_cryptoid_array",params:{cryptoID_array:i,show_progress:r}},function(I){if(IFCError.IFC_OK===I.error_code)if(I.intermediate)e(I);else{for(var h=[],d=0;d<I.result_array.length;d++){for(var A=!1,K=0;K<n.length;K++)if(n[K].getCryptoId()===I.result_array[d].crypto_id){A=n[K];break}if(!1!==A)for(var oe=0;oe<I.result_array[d].cert_list.length;oe++)h.push(new IFCCertificate(I.result_array[d].cert_list[oe],A))}e({error_code:IFCError.IFC_OK,certs_list:h})}else e(I)})}else e(t)})}function B(e,r,t,n,i){E(O(e),function(I){IFCError.IFC_OK===I.error_code?r&&r.length>0||!I.crypto.isPKCS11()?function Y(e,r,t,n,i,_,I){a.send({func_name:"key_gen",params:{containerId:e,userPin:r}},function(h){if(IFCError.IFC_OK===h.error_code){var A=new IFCDN(t,IFCConst.DN_SEPARATOR_INPUT).getSubjectArray(),oe=("clientAuth,emailProtection,1.2.643.2.2.34.6,"+n).split(","),ae=i.split(","),Ie=h.real_id;a.send({func_name:"req_gen",params:{containerId:Ie,userPin:r,subject:A,extendedKeyUsage:oe,certificatePolicies:ae,signInstrument:"",req_format:IFCConst.IFC_REQ_BASE64ENCODED,csrExtensions:_}},function(_e){IFCError.IFC_OK===_e.error_code?I({error_code:IFCError.IFC_OK,real_id:Ie,req_base64_length:_e.req_base64_length,req_base64:_e.req_base64,req:new IFCCertificateRequest(Ie,_e.req_base64)}):I(_e)})}else I(h)})}(e,r,t,I.crypto.getExtendedKeyUsage(),I.crypto.getCertificatePolicies(),n,i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):i(I)})}function x(e){a.send({func_name:"get_guid",params:{prefix:c}},e)}function w(e,r,t,n,i){x(function(_){if(IFCError.IFC_OK===_.error_code)return B(e+"/"+_.guid,r,t,n,i);i(_)})}function k(e,r,t){E(O(e),function(n){IFCError.IFC_OK===n.error_code?r&&r.length>0||!n.crypto.isPKCS11()?a.send({func_name:"key_delete",params:{containerId:e,userPin:r}},t):t({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):t(n)})}function G(e,r){a.send({func_name:"load_x509_from_data",params:{cert:e,cert_data_type:IFCConst.IFC_CERT_UNKNOWN}},r)}function T(e,r){a.send({func_name:"free_x509",params:{x509Handle:e}},r)}function X(e,r,t,n){t&&t.length>0?a.send({func_name:"p11_key_rename",params:{containerId:e,newContainerId:r,userPin:t}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}this.status=null,this.safariExtensionScheme="safariExtension://",this.listenPluginEvent=function(e,r){document.addEventListener?document.addEventListener(e,r,!1):document.documentElement.attachEvent("onpropertychange",function(t){t.propertyName===e&&r()})},a=N()?new function u(){var e=P,r=!1,t=!1;function I(d){if(d.source===e)try{var A=JSON.parse(d.data);A.type&&"FROM_IFC_EXT"===A.type?function i(d){if(d.intermediate)r(d);else if(r){var A=r;r=!1,A(d)}}(A.msg_data):A.type&&"IFC_EXT_DISCONNECT"===A.type&&function _(){if(r){var d=r;r=!1,d({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}t=!1}()}catch{}}this.send=function(d,A){if(r)A({error_code:IFCError.IFC_GENERAL_ERROR});else{var K=function h(){if(t)return IFCError.IFC_OK;try{e.addEventListener("message",I,!1)}catch{return IFCError.IFC_PLUGIN_UNDEFINED_ERROR}return t=!0,IFCError.IFC_OK}();K===IFCError.IFC_OK?function n(d,A){r=A;try{e.postMessage(JSON.stringify({type:"TO_IFC_EXT",msg_data:d}),"*")}catch{r=!1,A({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}(d,A):A({error_code:K})}}}:new function l(r){this.send=function(t,n){try{r.post_message(JSON.stringify(t),function(i,_){n(JSON.parse(_))})}catch{n({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}}(o),this.init=function(e){var r=this;this.status={isNativeMessaging:N(),isNewSafari:S(),extensionIsInstalled:null,pluginIsRunning:null},this.status.isNativeMessaging?setTimeout(function(){document.getElementById("ifcplugin-extension-is-installed")?(r.status.extensionIsInstalled=!0,r.status.pluginIsRunning=!!document.getElementById("ifc-plugin-is-installed")):r.status.extensionIsInstalled=!1,m("updatePluginStatus")},e?this.status.isNewSafari?5e3:500:4):(this.status.pluginIsRunning=!1,this.getPluginVersion(function(n){IFCError.IFC_OK===n.error_code&&(r.status.pluginIsRunning=!0)}),setTimeout(function(){m("updatePluginStatus")},1e3)),setTimeout(r.init.bind(r),5e3)},this.getLibVersion=function(e){return"2.2.1"},this.create=function(e,r,t){a.send({func_name:"create",params:{file_config:e,config_string:r,log_file_location:"",plugin_log_level:""}},t)},this.getPluginVersion=function(e){a.send({func_name:"version"},e)},this.getCryptoList=function(e){return p(e)},this.getPKCS11CryptoList=function(e){return F(IFCConst.IFC_CRYPTO_PKCS11,e)},this.getCAPICryptoList=function(e){return F(IFCConst.IFC_CRYPTO_CAPI,e)},this.getCAPILINUXCryptoList=function(e){return F(IFCConst.IFC_CRYPTO_CAPI_LINUX,e)},this.getCryptoById=function(e,r){return E(e,r)},this.getCertificateList=function(e){return M(e,0)},this.getCertificateListWithProgress=function(e){return M(e,1)},this.getCertificateListByCryptoId=function(e,r){return function b(e,r){E(e,function(t){if(IFCError.IFC_OK===t.error_code){var n=t.crypto;a.send({func_name:"get_list_certs",params:{cryptoID:n.getCryptoId()}},function(i){if(IFCError.IFC_OK===i.error_code){certsArray=[];for(var _=0;_<i.cert_list.length;_++)certsArray.push(new IFCCertificate(i.cert_list[_],n));r({error_code:IFCError.IFC_OK,certs_list:certsArray})}else r(i)})}else r(t)})}(e,r)},this.getKeyListByCryptoId=function(e,r,t){return function y(e,r,t){E(e,function(n){if(IFCError.IFC_OK===n.error_code){var i=n.crypto;!(r&&r.length>0)&&i.isPKCS11()&&t({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}),a.send({func_name:"get_list_keys",params:{cryptoID:i.getCryptoId(),userPin:r}},function(_){if(IFCError.IFC_OK===_.error_code){keysArray=[];for(var I=0;I<_.keys_list.length;I++)keysArray.push(new IFCCertificate(_.keys_list[I],i));t({error_code:IFCError.IFC_OK,keys_list:keysArray})}else t(_)})}else t(n)})}(e,r,t)},this.getCryptoIdByContainerId=function(e){return O(e)},this.signDataXml=function(e,r,t,n,i,_,I){return J(e,r,t,n,IFCConst.IFC_DATATYPE_DATA,i,_,I)},s&&(this.verifyDataXml=function(e,r,t,n){return V(e,r,t,IFCConst.IFC_DATATYPE_DATA,n)}),this.signDataBase64Xml=function(e,r,t,n,i,_,I){return J(e,r,t,n,IFCConst.IFC_DATATYPE_DATA_BASE64,i,_,I)},s&&(this.verifyDataBase64Xml=function(e,r,t,n){return V(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,n)}),this.signDataCmsAttached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},s&&(this.verifyDataCmsAttached=function(e,r,t){return D(e,r,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",t)}),this.signDataCmsDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},s&&(this.verifyDataCmsDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,t,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataCadesBesAttached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},s&&(this.verifyDataCadesBesAttached=function(e,r,t){return D(e,r,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",t)}),this.signDataCadesBesDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},s&&(this.verifyDataCadesBesDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,t,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataBase64CmsAttached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},s&&(this.verifyDataBase64CmsAttached=function(e,r,t){return D(e,r,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",t)}),this.signDataBase64CmsDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},s&&(this.verifyDataBase64CmsDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,t,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataBase64CadesBesAttached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},s&&(this.verifyDataBase64CadesBesAttached=function(e,r,t){return D(e,r,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",t)}),this.signDataBase64CadesBesDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},s&&(this.verifyDataBase64CadesBesDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,t,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataHash64CmsDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},s&&(this.verifyDataHash64CmsDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,t,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataHash64CadesBesDetached=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},s&&(this.verifyDataHash64CadesBesDetached=function(e,r,t,n){return D(e,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,t,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataSimple=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},s&&(this.verifyDataSimple=function(e,r,t,n,i){return D(e,r,IFCConst.IFC_SIGNTYPE_SIMPLE,t,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signHashSimple=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},s&&(this.verifyHashSimple=function(e,r,t,n,i){return D(e,r,IFCConst.IFC_SIGNTYPE_SIMPLE,t,IFCConst.IFC_DATATYPE_HASH_BASE64,n,i)}),this.signDataSimpleReversed=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,n,i)},s&&(this.verifyDataSimpleReversed=function(e,r,t,n,i){return D(e,r,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,t,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signDataBase64Simple=function(e,r,t,n,i){return R(e,r,t,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},s&&(this.verifyDataBase64Simple=function(e,r,t,n,i){return D(e,r,IFCConst.IFC_SIGNTYPE_SIMPLE,t,IFCConst.IFC_DATATYPE_DATA_BASE64,n,i)}),this.generateKeyPairAndCsrForContainerId=function(e,r,t,n){return function se(e,r,t,n){return B(e,r,t,"",n)}(e,r,t,n)},this.generateKeyPairAndCsrForContainerIdV2=function(e,r,t,n,i){return B(e,r,t,n,i)},this.generateKeyPairAndCsr=function(e,r,t,n){return function q(e,r,t,n){return w(e,r,t,"",n)}(e,r,t,n)},this.generateKeyPairAndCsrV2=function(e,r,t,n,i){return w(e,r,t,n,i)},s&&(this.makeSelfSignedCert=function(e,r,t,n){return function W(e,r,t,n){E(O(e),function(_){IFCError.IFC_OK===_.error_code?r&&r.length>0||!_.crypto.isPKCS11()?a.send({func_name:"make_cert",params:{containerId:e,userPin:r,request:t}},function(I){n(I)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(_)})}(e,r,t,n)}),this.putCertificate=function(e,r,t,n){return function j(e,r,t,n){E(O(e),function(_){IFCError.IFC_OK===_.error_code?r&&r.length>0||!_.crypto.isPKCS11()?G(t,function(I){if(IFCError.IFC_OK===I.error_code){var h=I.x509Handle;a.send({func_name:"set_x509",params:{containerId:e,userPin:r,x509Handle:h}},function(d){IFCError.IFC_OK===d.error_code?T(h,function(A){n(A)}):n(d)})}else n(I)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(_)})}(e,r,t,n)},this.deleteContainer=function(e,r,t){return k(e,r,t)},this.getGuid=function(e){return x(e)},this.setGuidPrefix=function(e){c=e},this.getGuidPrefix=function(){return c},this.getCertificate=function(e,r){return function Z(e,r){!function L(e,r){a.send({func_name:"load_x509_from_container",params:{containerId:e}},r)}(e,function(t){if(IFCError.IFC_OK===t.error_code){var n=t.x509Handle;a.send({func_name:"get_x509_info",params:{x509Handle:n}},function(i){if(IFCError.IFC_OK===i.error_code){var _=new IFCCertificateInfo(i.cert_info);T(n,function(I){r({error_code:I.error_code,cert:_})})}else r(i)})}else r(t)})}(e,r)},this.getCertificateFromString=function(e,r){return function H(e,r){G(e,function(t){if(IFCError.IFC_OK===t.error_code){var n=t.x509Handle;!function $(e,r){a.send({func_name:"get_x509_info",params:{x509Handle:e}},function(t){if(IFCError.IFC_OK===t.error_code){var n=new IFCCertificateInfo(t.cert_info);r({error_code:t.error_code,cert:n})}else r(t)})}(n,function(i){if(IFCError.IFC_OK===i.error_code){var _=i.cert;T(n,function(I){r({error_code:I.error_code,cert:_})})}else r(i)})}else r(t)})}(e,r)},this.getHash=function(e,r,t){return g(e,IFCConst.IFC_DATATYPE_DATA,r,t)},this.getHashFromBase64=function(e,r,t){return g(e,IFCConst.IFC_DATATYPE_DATA_BASE64,r,t)},this.encrypt=function(e,r,t,n,i){return function te(e,r,t,n,i){r&&r.length>0?G(t,function(_){IFCError.IFC_OK===_.error_code?(peer_x509Handle=_.x509Handle,a.send({func_name:"encrypt",params:{containerId:e,userPin:r,peerX509Handle:peer_x509Handle,data:n}},function(I){var d,h=I.error_code;IFCError.IFC_OK===I.error_code&&(d=new IFCEncrypted(I.enc_data_base64,I.enc_key_base64,I.cert_base64)),T(peer_x509Handle,function(A){IFCError.IFC_OK===A.error_code?IFCError.IFC_OK===h?i({error_code:h,encrypted:d}):i({error_code:h}):i(A)})})):i(_)}):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n,i)},this.decrypt=function(e,r,t,n,i,_){return function ne(e,r,t,n,i,_){r&&r.length>0?G(t,function(I){IFCError.IFC_OK===I.error_code?(peer_x509Handle=I.x509Handle,a.send({func_name:"decrypt",params:{containerId:e,userPin:r,peerX509Handle:peer_x509Handle,encryptedData:n,encryptedKey:i}},function(h){var A,d=h.error_code;IFCError.IFC_OK===h.error_code&&(A=h.decrypted),T(peer_x509Handle,function(K){IFCError.IFC_OK===K.error_code?IFCError.IFC_OK===d?_({error_code:d,decrypted:A}):_({error_code:d}):_(K)})})):_(I)}):_({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n,i,_)},this.pkcs11Init=function(e,r,t,n,i){return function Q(e,r,t,n,i){t&&t.length>0&&n&&n.length>0?a.send({func_name:"p11_init",params:{cryptoID:e,label:r,userPin:t,adminPin:n}},i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n,i)},this.pkcs11ChangeUserPin=function(e,r,t,n){return function Ce(e,r,t,n){r&&r.length>0&&t&&t.length>0?a.send({func_name:"p11_pin_change",params:{cryptoID:e,pinType:IFCConst.P11_PIN_TYPE_USER,currentPin:r,newPin:t}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n)},this.pkcs11UnlockUserPin=function(e,r,t){return function ie(e,r,t){r&&r.length>0?a.send({func_name:"p11_pin_unlock",params:{cryptoID:e,adminPin:r}},t):t({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t)},this.pkcs11ChangeAdminPin=function(e,r,t,n){return function ee(e,r,t,n){r&&r.length>0&&t&&t.length>0?a.send({func_name:"p11_pin_change",params:{cryptoID:e,pinType:IFCConst.P11_PIN_TYPE_ADMIN,currentPin:r,newPin:t}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n)},this.pkcs11RenameContainer=function(e,r,t,n){return X(e,r,t,n)},this.pkcs11MoveContainer=function(e,r,t,n){return function re(e,r,t,n){t&&t.length>0?E(O(e),function(i){IFCError.IFC_OK===i.error_code?null!=i.crypto&&i.crypto.isPKCS11()?k(O(e)+"/"+r,t,function(I){(IFCError.IFC_OK===I.error_code||IFCError.IFC_CONTAINER_NOT_FOUND===I.error_code)&&X(e,r,t,n)}):n({error_code:IFCError.IFC_BAD_PARAMS}):n(i)}):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(e,r,t,n)},this.sendAPDU=function(e,r,t){return function U(e,r,t){a.send({func_name:"send_apdu",params:{readerName:e,apdu_string:r}},t)}(e,r,t)}}}(window),function(P,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.textMaskCore=o():P.textMaskCore=o()}(this,function(){return function(P){function o(s){if(C[s])return C[s].exports;var f=C[s]={exports:{},id:s,loaded:!1};return P[s].call(f.exports,f,f.exports,o),f.loaded=!0,f.exports}var C={};return o.m=P,o.c=C,o.p="",o(0)}([function(P,o,C){"use strict";function s(m){return m&&m.__esModule?m:{default:m}}Object.defineProperty(o,"__esModule",{value:!0});var f=C(3);Object.defineProperty(o,"conformToMask",{enumerable:!0,get:function(){return s(f).default}});var c=C(2);Object.defineProperty(o,"adjustCaretPosition",{enumerable:!0,get:function(){return s(c).default}});var a=C(5);Object.defineProperty(o,"createTextMaskInputElement",{enumerable:!0,get:function(){return s(a).default}})},function(P,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.placeholderChar="_",o.strFunction="function"},function(P,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function C(c){var a=c.previousConformedValue,m=void 0===a?f:a,l=c.previousPlaceholder,u=void 0===l?f:l,S=c.currentCaretPosition,N=void 0===S?0:S,F=c.conformedValue,p=c.rawValue,E=c.placeholderChar,O=c.placeholder,R=c.indexesOfPipedChars,D=void 0===R?s:R,J=c.caretTrapIndexes,V=void 0===J?s:J;if(0===N||!p.length)return 0;var v=m.length,Y=O.length,M=F.length,b=p.length-v,y=b>0;if(b>1&&!y&&0!==v)return N;var x=0,q=void 0,w=void 0;if(!y||m!==F&&F!==O){var k=F.toLowerCase(),T=p.toLowerCase().substr(0,N).split(f).filter(function(n){return-1!==k.indexOf(n)});w=T[T.length-1];var $=u.substr(0,T.length).split(f).filter(function(n){return n!==E}).length,H=O.substr(0,T.length).split(f).filter(function(n){return n!==E}).length;!y&&(H!==$||void 0!==u[T.length-1]&&void 0!==O[T.length-2]&&u[T.length-1]!==E&&u[T.length-1]!==O[T.length-1]&&u[T.length-1]===O[T.length-2])&&$>0&&O.indexOf(w)>-1&&void 0!==p[N]&&(q=!0,w=p[N]);for(var ne=D.map(function(n){return k[n]}).filter(function(n){return n===w}).length,Q=T.filter(function(n){return n===w}).length,ie=O.substr(0,O.indexOf(E)).split(f).filter(function(n,i){return n===w&&p[i]!==n}).length+Q+ne+(q?1:0),ee=0,X=0;X<M&&(x=X+1,k[X]===w&&ee++,!(ee>=ie));X++);}else x=N-b;if(y){for(var U=x,e=x;e<=Y;e++)if(O[e]===E&&(U=e),O[e]===E||-1!==V.indexOf(e)||e===Y)return U}else if(q){for(var r=x-1;r>=0;r--)if(F[r]===w||-1!==V.indexOf(r)||0===r)return r}else for(var t=x;t>=0;t--)if(O[t-1]===E||-1!==V.indexOf(t)||0===t)return t};var s=[],f=""},function(P,o,C){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(u){return typeof u}:function(u){return u&&"function"==typeof Symbol&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u};o.default=function s(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m,N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(0,c.isArray)(S)){if((typeof S>"u"?"undefined":f(S))!==a.strFunction)throw new Error("Text-mask:conformToMask; The mask property must be an array.");S=S(u,N),S=(0,c.processCaretTraps)(S).maskWithoutCaretTraps}var F=N.guide,p=void 0===F||F,E=N.previousConformedValue,O=void 0===E?l:E,R=N.placeholderChar,D=void 0===R?a.placeholderChar:R,J=N.placeholder,V=void 0===J?(0,c.convertMaskToPlaceholder)(S,D):J,v=N.keepCharPositions,Y=!1===p&&void 0!==O,M=u.length,b=O.length,y=V.length,se=S.length,B=M-b,W=B>0,x=N.currentCaretPosition+(W?-B:0),q=x+Math.abs(B);if(!0===v&&!W){for(var w=l,k=x;k<q;k++)V[k]===D&&(w+=D);u=u.slice(0,x)+w+u.slice(x,M)}for(var G=u.split(l).map(function(r,t){return{char:r,isNew:t>=x&&t<q}}),L=M-1;L>=0;L--){var T=G[L].char;T!==D&&T===V[L>=x&&b===se?L-B:L]&&G.splice(L,1)}var H=l,Z=!1;e:for(var j=0;j<y;j++){var te=V[j];if(te===D){if(G.length>0)for(;G.length>0;){var ne=G.shift(),Q=ne.char,Ce=ne.isNew;if(Q===D&&!0!==Y){H+=D;continue e}if(S[j].test(Q)){if(!0===v&&!1!==Ce&&O!==l&&!1!==p&&W){for(var ie=G.length,ee=null,X=0;X<ie;X++){var re=G[X];if(re.char!==D&&!1===re.isNew)break;if(re.char===D){ee=X;break}}null!==ee?(H+=Q,G.splice(ee,1)):j--}else H+=Q;continue e}Z=!0}!1===Y&&(H+=V.substr(j,y));break}H+=te}if(Y&&!1===W){for(var U=null,e=0;e<H.length;e++)V[e]===D&&(U=e);H=null!==U?H.substr(0,U+1):l}return{conformedValue:H,meta:{someCharsRejected:Z}}};var c=C(4),a=C(1),m=[],l=""},function(P,o,C){"use strict";function f(F){return Array.isArray&&Array.isArray(F)||F instanceof Array}Object.defineProperty(o,"__esModule",{value:!0}),o.convertMaskToPlaceholder=function s(){var F=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.placeholderChar;if(!f(F))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(-1!==F.indexOf(p))throw new Error("Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\nThe placeholder character that was received is: "+JSON.stringify(p)+"\n\nThe mask that was received is: "+JSON.stringify(F));return F.map(function(E){return E instanceof RegExp?p:E}).join("")},o.isArray=f,o.isString=function c(F){return"string"==typeof F||F instanceof String},o.isNumber=function a(F){return"number"==typeof F&&void 0===F.length&&!isNaN(F)},o.isNil=function m(F){return typeof F>"u"||null===F},o.processCaretTraps=function l(F){for(var p=[],E=void 0;-1!==(E=F.indexOf(N));)p.push(E),F.splice(E,1);return{maskWithoutCaretTraps:F,indexes:p}};var u=C(1),S=[],N="[]"},function(P,o,C){"use strict";function s(g){return g&&g.__esModule?g:{default:g}}Object.defineProperty(o,"__esModule",{value:!0});var m=Object.assign||function(g){for(var v=1;v<arguments.length;v++){var Y=arguments[v];for(var M in Y)Object.prototype.hasOwnProperty.call(Y,M)&&(g[M]=Y[M])}return g},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g};o.default=function f(g){var v={previousConformedValue:void 0,previousPlaceholder:void 0};return{state:v,update:function(Y){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,b=M.inputElement,y=M.mask,se=M.guide,B=M.pipe,W=M.placeholderChar,x=void 0===W?E.placeholderChar:W,q=M.keepCharPositions,w=void 0!==q&&q,k=M.showMask,G=void 0!==k&&k;if(typeof Y>"u"&&(Y=b.value),Y!==v.previousConformedValue){(typeof y>"u"?"undefined":l(y))===D&&void 0!==y.pipe&&void 0!==y.mask&&(B=y.pipe,y=y.mask);var L=void 0,T=void 0;if(y instanceof Array&&(L=(0,p.convertMaskToPlaceholder)(y,x)),!1!==y){var $=function a(g){if((0,p.isString)(g))return g;if((0,p.isNumber)(g))return String(g);if(null==g)return O;throw new Error("The 'value' provided to Text Mask needs to be a string or a number. The value received was:\n\n "+JSON.stringify(g))}(Y),H=b.selectionEnd,Z=v.previousConformedValue,j=v.previousPlaceholder,te=void 0;if((typeof y>"u"?"undefined":l(y))===E.strFunction){if(!1===(T=y($,{currentCaretPosition:H,previousConformedValue:Z,placeholderChar:x})))return;var ne=(0,p.processCaretTraps)(T);te=ne.indexes,L=(0,p.convertMaskToPlaceholder)(T=ne.maskWithoutCaretTraps,x)}else T=y;var ie={previousConformedValue:Z,guide:se,placeholderChar:x,pipe:B,placeholder:L,currentCaretPosition:H,keepCharPositions:w},X=(0,F.default)($,T,ie).conformedValue,re=(typeof B>"u"?"undefined":l(B))===E.strFunction,U={};re&&(!1===(U=B(X,m({rawValue:$},ie)))?U={value:Z,rejected:!0}:(0,p.isString)(U)&&(U={value:U}));var e=re?U.value:X,r=(0,S.default)({previousConformedValue:Z,previousPlaceholder:j,conformedValue:e,placeholder:L,rawValue:$,currentCaretPosition:H,placeholderChar:x,indexesOfPipedChars:U.indexesOfPipedChars,caretTrapIndexes:te}),i=e===L&&0===r?G?L:O:e;v.previousConformedValue=i,v.previousPlaceholder=L,b.value!==i&&(b.value=i,function c(g,v){document.activeElement===g&&(J?V(function(){return g.setSelectionRange(v,v,R)},0):g.setSelectionRange(v,v,R))}(b,r))}}}}};var S=s(C(2)),F=s(C(3)),p=C(4),E=C(1),O="",R="none",D="object",J=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),V=typeof requestAnimationFrame<"u"?requestAnimationFrame:setTimeout}])});